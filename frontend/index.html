<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OCCT – Dashboard</title>

  <script src="{{ url_for('static', filename='js/site.js') }}"></script>

  <link rel="icon" type="image/png" href="{{ url_for('static', filename='assets/occt-logo.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme-overrides.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
</head>

<body class="dash-body">
  <nav class="topbar">
    <div class="brand">OCCT</div>
    <ul class="navlinks center">
      <li><a href="/home">Home</a></li>
      <li class="active"><a href="/index" data-live-only>Dashboard</a></li>
      <li><a href="/detections" data-live-only>Detections</a></li>
      <li><a href="/audit" data-live-only>Audit</a></li>
      <li><a href="/remediation" data-live-only>Remediation</a></li>
      <li><a href="/settings">Settings</a></li>
    </ul>
    <div class="nav-right">
      <small id="lastScanHeaderHint" class="nav-hint muted">
        <span class="text">Last scan: —</span>
      </small>
    </div>
  </nav>

  <main class="container">

    <section class="grid grid-3">
      <div class="card">
        <h3>Compliance Status</h3>


        <div class="donut-wrap">
          <svg class="donut" viewBox="0 0 36 36" aria-label="Donut chart">

            <path
              class="donut-track"
              d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32"
            />
            <path
              id="donut-value"
              class="donut-value"
              stroke-dasharray="0, 100"
              d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32"
            />
            <circle class="donut-cap" cx="18" cy="2" r="1.1"></circle>
          </svg>

          <div class="donut-center">
            <div class="donut-number" id="nonCompliantPct">—</div>
            <div class="donut-sub">Compliance</div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Audit Checks</h3>
        <div class="kpi-big" id="kpiTotal">—</div>
        <div class="kpi-row">
          <span class="muted">Passed</span><span id="kpiPassed">—</span>
        </div>
        <div class="kpi-row">
          <span class="muted">Failed</span><span id="kpiFailed">—</span>
        </div>
      </div>

      <div class="card">
        <h3>Weighted Compliance Score</h3>
        <div class="donut-wrap">
          <canvas id="weightedComplianceChart" width="180" height="180" aria-label="Weighted compliance donut"></canvas>
          <div class="donut-center">
            <div class="donut-number" id="wcPercent">—</div>
            <div class="donut-sub">/100</div>
          </div>
        </div>
      </div>
    </section>

    <section class="grid grid-2">
      <div class="card">
        <h3>Compliance Over Time</h3>

        <div class="legend">
          <span class="key key-green"></span> Compliant
          <span class="spacer"></span>
          <span class="key key-red"></span> Non-Compliant
        </div>

        <div class="bars" id="barChart"></div>

        <div class="axis-x" id="axisX"></div>
      </div>

      <div class="card">
        <h3>Audit Log</h3>

        <div class="table" id="auditPreview"></div>

        <a class="link" href="/audit">See all</a>
      </div>
    </section>

  </main>

  <script defer src="{{ url_for('static', filename='js/loader.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/index.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/lastscan-header.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/dashboard-alert.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <script defer src="{{ url_for('static', filename='js/weighted-compliance.js') }}"></script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OCCT – Settings</title>

  <!-- Load helpers BEFORE CSS to prevent theme flash -->
  <script src="{{ url_for('static', filename='js/site.js') }}"></script>

  <link rel="icon" type="png" href="{{ url_for('static', filename='assets/occt-logo.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">
</head>

<body class="dash-body">
  <nav class="topbar">
    <div class="brand">OCCT</div>
    <ul class="navlinks center">
      <li><a href="/">Dashboard</a></li>
      <li><a href="/audit">Audit</a></li>
      <li><a href="/remediation">Remediation</a></li>
      <li class="active"><a href="/settings">Settings</a></li>
    </ul>
    <div class="nav-right">
      <small id="lastScanHeaderHint" class="nav-hint muted">
        <span class="text">Last scan: —</span>
      </small>
    </div>
  </nav>

  <main class="container">
    <h1 class="page-title">Settings</h1>
    <br>

    <form id="settingsForm" class="card settings-card">
      <!-- Appearance -->
      <h2 class="section-title">Appearance</h2>
      <div class="field row">
        <label for="themeDark" class="label">Theme</label>
        <label class="switch">
          <input id="themeDark" type="checkbox">
          <span class="slider"></span>
        </label>
        <div class="help">Enable dark theme</div>
      </div>

      <hr class="sep"/>

      <!-- Data -->
      <h2 class="section-title">Data</h2>
      <div class="field">
        <label for="apiMode" class="label">Data source</label>
        <select id="apiMode" class="input select">
          <option value="sample">Samples (DB-backed via /api/sample)</option>
          <option value="live">Live (DB-backed via /api/live)</option>
        </select>
        <div class="help">Choose where new scans come from. Both modes read from the database.</div>
      </div>

      <!-- Rescan control -->
      <div class="field row">
        <label class="label" for="rescanBtn">Rescan</label>
        <button type="button" id="rescanBtn" class="btn">Rescan</button>
        <small id="rescanHint" class="hint" hidden></small>
        <div id="rescanStatus" class="help" aria-live="polite"></div>
      </div>

      <hr class="sep"/>

      <!-- Reports -->
      <h2 class="section-title">Reports</h2>
      <div class="field row">
        <label class="label" for="reportBtn">Compliance report</label>
        <div class="row">
          <button type="button" id="reportBtn" class="btn">View report</button>
          <button type="button" id="reportDlBtn" class="btn secondary" style="margin-left:.5rem">Download HTML</button>
        </div>
        <div class="help">Summarizes Dashboard & Remediation. Print → Save as PDF from the report page.</div>
      </div>

      <hr class="sep"/>

      <div class="actions-row">
        <!-- Save removed -->
        <button type="button" id="resetBtn" class="btn secondary">Reset</button>
        <div id="toast" class="toast" hidden></div>
      </div>

      <!-- Logout -->
      <div class="actions-row">
        <button type="button" id="logoutBtn" class="btn danger">Log out</button>
      </div>
    </form>
  </main>

  <script defer src="{{ url_for('static', filename='js/loader.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/settings.js') }}"></script>
  <script defer src="{{ url_for('static', filename='js/lastscan-header.js') }}"></script>
</body>
</html>
